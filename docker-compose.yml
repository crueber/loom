
services:
  loom:
    build: .
    container_name: loom
    ports:
      - "8080:8080"
    volumes:
      - ./data:/data
    environment:
      - DATABASE_PATH=/data/bookmarks.db
      - PORT=8080
      - SECURE_COOKIE=false
      # OAuth2 Configuration (REQUIRED)
      - OAUTH2_ISSUER_URL=${OAUTH2_ISSUER_URL}
      - OAUTH2_CLIENT_ID=${OAUTH2_CLIENT_ID}
      - OAUTH2_CLIENT_SECRET=${OAUTH2_CLIENT_SECRET}
      - OAUTH2_REDIRECT_URL=${OAUTH2_REDIRECT_URL:-http://localhost:8080/auth/callback}
      - SESSION_KEY=${SESSION_KEY}
      - ENCRYPTION_KEY=${ENCRYPTION_KEY}
      - SESSION_MAX_AGE=31536000
    restart: unless-stopped

volumes:
  loom-data:
